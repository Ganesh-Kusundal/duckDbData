# .envrc (works for both bash & zsh)
CONDA_BASE="$HOME/miniforge"
if [ -f "$CONDA_BASE/etc/profile.d/conda.sh" ]; then
  . "$CONDA_BASE/etc/profile.d/conda.sh"
  conda activate "$(pwd)/.conda"    # your project env
else
  # Fallback: try conda hook dynamically
  if [ -n "$BASH_VERSION" ]; then
    eval "$("$HOME/miniforge/bin/conda" shell.bash hook)"
  else
    eval "$("$HOME/miniforge/bin/conda" shell.zsh hook)"
  fi
  conda activate "$(pwd)/.conda"
fi

# (optional) project env vars
export LOG_DIR="$(pwd)/.logs"
export PYTHONPATH="$(pwd):${PYTHONPATH}"

# Keep PATH clean
_path_dedup() { awk -v RS=':' '!a[$0]++' <<<"$1" | paste -sd: -; }
export PATH="$(_path_dedup "${PATH}")"
